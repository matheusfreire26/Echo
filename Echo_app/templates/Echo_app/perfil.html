{% extends "Echo_app/base.html" %}
{% load static %}

{% block title %}Meu Perfil{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'Echo_app/css/perfil.css' %}?v={% now 'U' %}">
{% endblock %}

{% block content %}

<div class="container" style="max-width: 800px; margin: 0 auto; padding: 20px;">

    <h1 class="main-title" style="text-align: center; margin-bottom: 30px; color: #333;">Meu Perfil</h1>

    <div class="perfil-card" style="background: #fff; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 30px;">

        <!-- CABE√áALHO DO PERFIL -->
        <div class="perfil-header" style="display: flex; flex-direction: column; align-items: center; text-align: center;">
            
            <!-- √ÅREA DA FOTO (AVATAR) -->
            <div class="perfil-avatar-container" style="position: relative; margin-bottom: 20px;">
                {% if perfil.foto_perfil %}
                    <!-- CASO 1: Usu√°rio TEM foto -->
                    <img id="perfil-avatar-img" 
                         src="{{ perfil.foto_perfil.url }}" 
                         alt="Foto de Perfil" 
                         style="width: 150px; height: 150px; object-fit: cover; border-radius: 50%; border: 4px solid #f0f0f0; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                {% else %}
                    <!-- CASO 2: Usu√°rio N√ÉO TEM foto (Gera iniciais autom√°ticas) -->
                    <img id="perfil-avatar-img" 
                         src="https://ui-avatars.com/api/?name={{ request.user.first_name|default:request.user.username }}&background=0D8ABC&color=fff&size=150&font-size=0.5&bold=true" 
                         alt="Avatar Padr√£o" 
                         style="width: 150px; height: 150px; object-fit: cover; border-radius: 50%; border: 4px solid #f0f0f0; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                {% endif %}

                <!-- √çcone de Editar Foto -->
                <a href="{% url 'Echo_app:perfil_editar' %}" title="Alterar foto" 
                   style="position: absolute; bottom: 5px; right: 5px; background: #fff; border-radius: 50%; width: 40px; height: 40px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; color: #333; text-decoration: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M21.731 2.269a2.64 2.64 0 0 0-3.737 0l-12.72 12.72A1.97 1.97 0 0 0 5.25 15.75v3.626h3.626a1.97 1.97 0 0 0 1.404-.579l12.72-12.72a2.64 2.64 0 0 0 0-3.737ZM7.125 18v1.875H5.25a.375.375 0 0 1-.375-.375v-1.5h1.875ZM18.75 8.25l-7.5-7.5-1.5 1.5 7.5 7.5 1.5-1.5Z" />
                    </svg>
                </a>
            </div>
            
            <!-- INFO DO USU√ÅRIO -->
            <div class="perfil-info">
                <h3 class="saudacao" style="margin: 0; font-weight: bold; font-size: 1.5rem;">
                    {{ request.user.first_name }} {{ request.user.last_name }}
                </h3>
                <p class="user-email" style="color: #6c757d; margin: 5px 0;">{{ request.user.email }}</p>

                {% if perfil.biografia %}
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 15px auto; max-width: 500px;">
                        <p class="user-bio" style="white-space: pre-line; margin: 0; color: #555;">{{ perfil.biografia }}</p>
                    </div>
                {% endif %}

                <div style="margin-top: 20px;">
                    <a href="{% url 'Echo_app:perfil_editar' %}" class="btn-editar" style="background-color: #333; color: white; padding: 10px 30px; border-radius: 25px; text-decoration: none; font-weight: 500; display: inline-block;">
                        Editar Perfil
                    </a>
                </div>
            </div>
        </div>
        
        <hr class="perfil-divider" style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">

        <!-- CATEGORIAS DE INTERESSE -->
        {% if perfil.categorias_de_interesse.exists %}
        <div class="perfil-categorias">
            <h5 class="categorias-title" style="margin-bottom: 15px; font-weight: 600; color: #333;">Meus Interesses</h5>
            <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                {% for categoria in perfil.categorias_de_interesse.all %}
                    <span style="background: #e9ecef; color: #495057; padding: 6px 15px; border-radius: 20px; font-size: 0.9rem; font-weight: 500;">
                        {{ categoria.nome }}
                    </span>
                {% endfor %}
            </div>
        </div>
        <hr class="perfil-divider" style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">
        {% endif %}

        <!-- MENU DE OP√á√ïES -->
        <nav class="menu-opcoes" style="display: flex; flex-direction: column; gap: 8px;">
            
            <a class="menu-item" href="{% url 'Echo_app:noticias_curtidas' %}" style="padding: 12px; text-decoration: none; color: #333; display: flex; align-items: center; border-radius: 8px; transition: background 0.2s;">
                <span style="margin-right: 15px; font-size: 1.2rem; width: 25px; text-align: center;">‚ù§Ô∏è</span> 
                <span style="font-weight: 500;">Not√≠cias Curtidas</span>
            </a>

            <a class="menu-item" href="{% url 'Echo_app:noticias_salvas' %}" style="padding: 12px; text-decoration: none; color: #333; display: flex; align-items: center; border-radius: 8px; transition: background 0.2s;">
                <span style="margin-right: 15px; font-size: 1.2rem; width: 25px; text-align: center;">üîñ</span> 
                <span style="font-weight: 500;">Not√≠cias Salvas</span>
            </a>

            <a class="menu-item" href="{% url 'Echo_app:configuracoes_conta' %}" style="padding: 12px; text-decoration: none; color: #333; display: flex; align-items: center; border-radius: 8px; transition: background 0.2s;">
                <span style="margin-right: 15px; font-size: 1.2rem; width: 25px; text-align: center;">‚öôÔ∏è</span> 
                <span style="font-weight: 500;">Configura√ß√µes da Conta</span>
            </a>

            <hr style="margin: 10px 0; border-top: 1px solid #eee;">

            <!-- A√á√ïES DE CONTA -->
            <a class="menu-item acao-logout" href="{% url 'Echo_app:sair' %}" style="padding: 12px; text-decoration: none; color: #dc3545; display: flex; align-items: center; border-radius: 8px; transition: background 0.2s;">
                <span style="margin-right: 15px; font-size: 1.2rem; width: 25px; text-align: center;">üö™</span> 
                <span style="font-weight: 500;">Sair da Conta</span>
            </a>
            
            <a class="menu-item acao-deletar" href="{% url 'Echo_app:excluir_conta' %}" style="padding: 12px; text-decoration: none; color: #6c757d; font-size: 0.9rem; display: flex; align-items: center; border-radius: 8px; transition: background 0.2s;">
                <span style="margin-right: 15px; font-size: 1.2rem; width: 25px; text-align: center;">‚ùå</span> 
                <span>Excluir Conta Permanentemente</span>
            </a>
            
        </nav>
        
    </div>
</div>

<!-- Estilo CSS Simples para Hover nos menus -->
<style>
    .menu-item:hover {
        background-color: #f8f9fa;
    }
    .acao-logout:hover {
        background-color: #fff5f5;
        color: #bd2130 !important;
    }
    .btn-editar:hover {
        background-color: #000 !important;
        opacity: 0.9;
    }
</style>

{% endblock %}